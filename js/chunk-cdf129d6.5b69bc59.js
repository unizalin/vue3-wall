(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cdf129d6"],{"1bab":function(e,t,a){"use strict";a.r(t);var s=a("7a23");const n=Object(s["h"])("div",{class:"block-title"}," 張貼動態 ",-1),c={class:"draft-post"},r={class:"draft-post__post"},o=Object(s["h"])("p",{class:"draft-post__post__label"},"貼文內容",-1),i={class:"draft-post__textarea"},l={style:{"margin-top":"16px"}},u=Object(s["h"])("label",{for:"upload",class:"text-btn black"},"上傳圖片",-1),b=["src"],d={key:1,class:"draft-post__img"},g={key:2,class:"error-message"},p={key:3,class:"error-message"},m={style:{"max-width":"323px margin: 0 auto"}};function j(e,t,a,j,O,h){return Object(s["w"])(),Object(s["g"])("div",null,[n,Object(s["h"])("div",c,[Object(s["h"])("div",r,[o,Object(s["h"])("div",i,[Object(s["N"])(Object(s["h"])("textarea",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),type:"text",name:"nickname",placeholder:"輸入您的貼文內容稱"},null,512),[[s["J"],e.content]])])]),Object(s["h"])("div",l,[u,Object(s["h"])("input",{id:"upload",style:{visibility:"hidden"},type:"file",accept:"image/png, image/gif, image/jpeg",onChange:t[1]||(t[1]=(...t)=>e.showFile&&e.showFile(...t))},null,32)]),e.preViewImage?(Object(s["w"])(),Object(s["g"])("img",{key:0,class:"draft-post__img",style:{"margin-top":"16px"},src:e.preViewImage},null,8,b)):(Object(s["w"])(),Object(s["g"])("div",d)),e.errorImageMessageVised?(Object(s["w"])(),Object(s["g"])("p",g,Object(s["G"])(e.errorImageMessage),1)):Object(s["f"])("",!0),e.errorContentMessageVised?(Object(s["w"])(),Object(s["g"])("p",p,Object(s["G"])(e.errorContentMessage),1)):Object(s["f"])("",!0),Object(s["h"])("div",m,[Object(s["h"])("button",{style:{"margin-top":"32px"},class:"btn secondary",onClick:t[2]||(t[2]=(...t)=>e.submitPost&&e.submitPost(...t))}," 送出貼文 ")])])])}var O=a("5464"),h=a("5502"),f=a("685c"),v=a("a18c"),w=Object(s["l"])({name:"PublishPost",setup(){const e=Object(h["b"])(),t=Object(s["B"])("");let a=Object(s["A"])({});const n=Object(s["A"])({name:"",thumbnail:null,size:null,unit:"KB"}),c=Object(s["B"])(""),r=Object(s["B"])(null),o=Object(s["B"])(!0),i=Object(s["B"])(""),l=Object(s["B"])(!0),u=Object(s["B"])("");let b;const d={noContent:"沒有貼文內容，請填寫",imageSizeError:"圖片檔案過大，僅限 1mb 以下檔案",imageTypeError:"圖片格式錯誤，僅限 JPG、PNG 圖片"},g=async e=>{a=e.target.files[0],console.log("showFile",a),n.name=a.name,n.thumbnail=window.URL.createObjectURL(a),n.size=~~(.001*a.size),c.value=n.name,r.value=URL.createObjectURL(a),n.size>1e3?(o.value=!0,i.value=d.imageSizeError):Object(O["c"])(n.name)?o.value=!1:(o.value=!0,i.value=d.imageTypeError),b=await Object(f["a"])(a),console.log("uploadImageRes",b)},p=async()=>{try{var a;if(l.value=!1,""===t.value)return l.value=!0,u.value=d.noContent,!1;if(o.value)return!1;const s=null===(a=e.getters["user/userProfile"])||void 0===a?void 0:a._id,{status:n,data:c}=await e.dispatch("post/addPost",{userId:s,content:t.value,imgUrl:b.data.imageUrl});"success"===n&&v["a"].push({path:"/home"})}catch(s){}};return{content:t,title:c,preViewImage:r,errorImageMessageVised:o,errorImageMessage:i,errorContentMessageVised:l,errorContentMessage:u,showFile:g,submitPost:p}}}),y=a("d959"),_=a.n(y);const P=_()(w,[["render",j]]);t["default"]=P},5464:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return n})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));const s=e=>e.length>=2,n=e=>/.+@.+\..+/.test(e),c=e=>/^((?=\S*?[A-Za-z])(?=\S*?[0-9]).{7,})\S$/.test(e),r=(e,t)=>e==t,o=e=>/\.(jpg|png|JPG|PNG|jpeg)$/.test(e)},"685c":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("b775");function n(e){console.log("uploadImage",e);const t=new FormData;return t.append("file",e),Object(s["a"])({url:"/files/uploadImage",method:"POST",data:t})}}}]);
//# sourceMappingURL=chunk-cdf129d6.5b69bc59.js.map