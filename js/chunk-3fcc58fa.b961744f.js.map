{"version":3,"sources":["webpack:///./src/api/image.js","webpack:///./src/views/Profile.vue","webpack:///./src/components/EditUserInfo.vue","webpack:///./src/components/EditUserInfo.vue?fd8c","webpack:///./src/components/ResetPassword.vue","webpack:///./src/components/ResetPassword.vue?4866","webpack:///./src/views/Profile.vue?094a"],"names":["uploadImage","file","console","log","formData","FormData","append","request","url","method","data","_createElementVNode","class","style","_createElementBlock","_hoisted_1","_ctx","onClick","_createVNode","_Transition","name","_createBlock","_component_EditUserInfo","key","_component_ResetPassword","for","src","photo","_hoisted_8","id","type","accept","onChange","_hoisted_10","placeholder","$event","_hoisted_13","sex","value","checked","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_20","_hoisted_21","_hoisted_22","_toDisplayString","defineComponent","setup","store","useStore","userName","ref","gender","errorMessageEnum","noContent","imageSizeError","imageTypeError","storeUserProfile","computed","getters","title","preViewImage","errorImageMessageVised","errorImageMessage","errorNameMessageVised","errorNameMessage","uploadImageRes","reactive","fs","thumbnail","size","unit","showFile","async","e","target","files","window","URL","createObjectURL","imageTypeRule","updateProfile","editProfile","imageUrl","resData","dispatch","status","alertSuccess","error","alertError","message","onMounted","__exports__","_hoisted_4","_hoisted_7","disabled","components","password","confirmPassword","checkPassWordSame","passwordRule","updatePassWord","alert","res","EditUserInfo","ResetPassword","tagKey","clickTag","render"],"mappings":"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","file":"js/chunk-3fcc58fa.b961744f.js","sourcesContent":["import request from '@/utils/request'\n\nexport function uploadImage (file) {\n  console.log('uploadImage', file)\n  const formData = new FormData()\n  formData.append('file', file)\n\n  return request({\n    url: '/files/uploadImage',\n    method: 'POST',\n    data: formData\n  })\n}\n","<template>\n  <div>\n    <div class=\"block-title\">\n      修改個人資料\n    </div>\n    <ul class=\"tabs\" style=\"margin-top: 32px; margin-left: 16px;\">\n      <li class=\"tab\" :class=\"{'active': tagKey=== 'userInfo'}\" @click=\"clickTag('userInfo')\">暱稱修改</li>\n      <li class=\"tab\" :class=\"{'active': tagKey=== 'password'}\"  @click=\"clickTag('password')\">重設密碼</li>\n    </ul>\n    <transition name=\"fall\">\n      <EditUserInfo v-if=\"tagKey === 'userInfo'\" />\n    </transition>\n    <transition name=\"fall\">\n      <ResetPassword v-if=\"tagKey === 'password'\" />\n    </transition>\n  </div>\n</template>\n<script>\nimport { defineComponent, ref } from 'vue'\nimport EditUserInfo from '@/components/EditUserInfo'\nimport ResetPassword from '@/components/ResetPassword'\nexport default defineComponent({\n  components: {\n    EditUserInfo,\n    ResetPassword\n  },\n  setup () {\n    const tagKey = ref('userInfo')\n    function clickTag (key) {\n      tagKey.value = key\n    }\n    return {\n      tagKey,\n      clickTag\n    }\n  }\n})\n</script>\n","<template>\n  <div class=\"card round-radius\">\n    <div class=\"center-container\">\n      <div class=\"avatar-upload\">\n        <div class=\"avatar\">\n          <img v-if=\"preViewImage\" class=\"avatar__img\" :src=\"preViewImage\" />\n          <img v-else class=\"avatar__img\" :src=\"storeUserProfile.photo\" />\n        </div>\n        <div style=\"margin-top: 16px\">\n          <label for=\"upload\" class=\"text-btn black\">上傳大頭照</label>\n          <input id=\"upload\" style=\"visibility:hidden\" type=\"file\" accept=\"image/png, image/gif, image/jpeg\" @change=\"showFile\">\n        </div>\n      </div>\n      <div class=\"user-info\">\n        <p class=\"user-info__label\">暱稱</p>\n        <div class=\"form-input\" style=\"margin-top: 4px;\">\n          <input type=\"text\" name=\"nickname\" placeholder=\"名稱\" v-model=\"storeUserProfile.name\">\n        </div>\n\n      </div>\n      <div class=\"user-info\">\n        <p class=\"user-info__label\">性別</p>\n        <div class=\"form-radio\" style=\"margin-top: 8px;\">\n          <label class=\"radio\">\n            <input type=\"radio\" name=\"gender\" class=\"radio__input\" v-model=\"storeUserProfile.sex\" value=\"male\" checked>\n            <i class=\"material-icons un-checked radio__input-icon\">radio_button_unchecked</i>\n            <i class=\"material-icons checked radio__input-icon\">radio_button_checked</i>\n            <p class=\"radio__input-text\">男性</p>\n          </label>\n          <label class=\"radio\" style=\"margin-left: 32px;\">\n            <input type=\"radio\" name=\"gender\" v-model=\"storeUserProfile.sex\" value=\"female\" class=\"radio__input\">\n            <i class=\"material-icons un-checked radio__input-icon\">radio_button_unchecked</i>\n            <i class=\"material-icons checked radio__input-icon\">radio_button_checked</i>\n            <p class=\"radio__input-text\">女性</p>\n          </label>\n        </div>\n      </div>\n      <p v-if=\"!errorNameMessageVised\" class=\"user-info__error-message text-align-center\" style=\"margin-top: 32px;\">名字不能為空\n      </p>\n      <p v-if=\"errorImageMessageVised\" class=\"error-message\">{{ errorImageMessage }}</p>\n      <!-- <p class=\"user-info__error-message text-align-center\">\n        1.圖片寬高比必需為 1:1，請重新輸入\n      </p>\n      <p class=\"user-info__error-message text-align-center\">\n        2. 解析度寬度至少 300像素以上，請重新輸入\n      </p> -->\n      <button class=\"btn secondary\" @click=\"updateProfile\" style=\"margin-top: 32px;\">\n        送出更新\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { uploadImage } from '@/api/image.js'\nimport { alertSuccess, alertError } from '@/utils/swal'\nimport { imageTypeRule } from '@/utils/validation'\n\nexport default defineComponent({\n  name: 'EditUserInfo',\n  setup () {\n    const store = useStore()\n    const userName = ref('')\n    const photo = ref('')\n    const gender = ref('')\n    const errorMessageEnum = {\n      noContent: '沒有圖片，請選擇圖片上傳',\n      imageSizeError: '解析度寬度至少 300像素以上，請重新輸入',\n      imageTypeError: '圖片格式錯誤，僅限 JPG、PNG 圖片'\n    }\n    const storeUserProfile = computed(() => {\n      return store.getters['user/storeUserProfile']\n    })\n\n    const title = ref('') // 圖片標題\n    const preViewImage = ref(null) // 圖片預覽\n    const errorImageMessageVised = ref(true)\n    const errorImageMessage = ref('')\n    const errorNameMessageVised = ref(true)\n    const errorNameMessage = ref('')\n    let uploadImageRes\n    let file = reactive({})\n    const fs = reactive({\n      name: '', // input 的圖檔名稱\n      thumbnail: null, // input 的圖片縮圖\n      size: null, // input 的圖片大小\n      unit: 'KB'\n    })\n    const showFile = async (e) => {\n      file = e.target.files[0] // input type=\"file\" 的值\n      fs.name = file.name // input 的圖檔名稱\n      fs.thumbnail = window.URL.createObjectURL(file) // input 的圖片縮圖\n      fs.size = ~~(file.size * 0.001) // input 的圖片大小\n      title.value = fs.name // 預設 input 的圖檔名稱為圖片上傳時的圖片標題\n      preViewImage.value = URL.createObjectURL(file)\n\n      if (fs.size > 1000) {\n        errorImageMessageVised.value = true\n        errorImageMessage.value = errorMessageEnum.imageSizeError\n      } else if (!imageTypeRule(fs.name)) {\n        errorImageMessageVised.value = true\n        errorImageMessage.value = errorMessageEnum.imageTypeError\n      } else {\n        errorImageMessageVised.value = false\n      }\n      uploadImageRes = await uploadImage(file)\n    }\n\n    const updateProfile = async () => {\n      try {\n        if (storeUserProfile.value.name === '') {\n          errorNameMessageVised.value = false\n          return false\n        }\n        const editProfile = {\n          name: storeUserProfile.value.name,\n          sex: storeUserProfile.value.sex,\n          photo: uploadImageRes ? uploadImageRes.data.imageUrl : storeUserProfile.value.photo\n        }\n        const resData = await store.dispatch('user/updateUserProfile', editProfile)\n        if (resData.status === 'success') {\n          await store.dispatch('user/getUserProfile')\n          await store.dispatch('user/getStoreUserProfile')\n        }\n        alertSuccess('成功修改個人資料')\n      } catch (error) {\n        alertError(error.message)\n        return error\n      }\n    }\n\n    onMounted(async () => {\n      await store.dispatch('user/getStoreUserProfile')\n    })\n    return {\n      userName,\n      photo,\n      gender,\n      storeUserProfile,\n      showFile,\n      preViewImage,\n      errorImageMessageVised,\n      errorImageMessage,\n      errorNameMessageVised,\n      errorNameMessage,\n      updateProfile\n    }\n  }\n})\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n","import { render } from \"./EditUserInfo.vue?vue&type=template&id=61596680\"\nimport script from \"./EditUserInfo.vue?vue&type=script&lang=js\"\nexport * from \"./EditUserInfo.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/uniza/Desktop/vue3-wall/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div class=\"card round-radius\">\n    <div class=\"center-container\">\n      <div class=\"user-password\">\n        <p class=\"user-password__label\">輸入新密碼</p>\n        <div class=\"form-input\" style=\"margin-top: 4px;\">\n          <input v-model.trim=\"password\" type=\"password\" name=\"password\" placeholder=\"請輸入新密碼\">\n        </div>\n      </div>\n      <div class=\"user-password\">\n        <p class=\"user-password__label\">再次輸入</p>\n        <div class=\"form-input\" style=\"margin-top: 4px;\">\n          <input v-model.trim=\"confirmPassword\" type=\"password\" name=\"password-confirmation\" placeholder=\"再次輸入新密碼\">\n        </div>\n      </div>\n      <button class=\"btn\" :class=\"{ disabled : !checkPassWordSame }\" @click=\"updatePassWord\" style=\"margin-top: 32px;\">重設密碼</button>\n    </div>\n  </div>\n</template>\n<script>\nimport { computed, defineComponent, ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { passwordRule } from '@/utils/validation'\n\nexport default defineComponent({\n  name: 'ResetPassword',\n  components: {},\n  setup () {\n    const store = useStore()\n\n    const password = ref('')\n    const confirmPassword = ref('')\n    const checkPassWordSame = computed(() => {\n      if (password.value === confirmPassword.value) {\n        return passwordRule(password.value)\n      }\n      return false\n    })\n    const updatePassWord = async () => {\n      if (!checkPassWordSame.value) {\n        alert('密碼需至少 8 碼以上，並英文、數字混合')\n      }\n      const res = await store.dispatch('user/updatePassword', {\n        password: password.value,\n        confirmPassword: confirmPassword.value\n      })\n      if (res.status === 'success') {\n        alert('成功修改個人資料')\n        await store.dispatch('user/getUserProfile')\n      }\n    }\n    return {\n      password,\n      confirmPassword,\n      checkPassWordSame,\n      updatePassWord\n    }\n  }\n\n})\n</script>\n","import { render } from \"./ResetPassword.vue?vue&type=template&id=b80b7b2c\"\nimport script from \"./ResetPassword.vue?vue&type=script&lang=js\"\nexport * from \"./ResetPassword.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/uniza/Desktop/vue3-wall/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Profile.vue?vue&type=template&id=72b69e46\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/uniza/Desktop/vue3-wall/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}