(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fcc58fa"],{"685c":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("b775");function c(e){console.log("uploadImage",e);const t=new FormData;return t.append("file",e),Object(s["a"])({url:"/files/uploadImage",method:"POST",data:t})}},c66d:function(e,t,a){"use strict";a.r(t);var s=a("7a23");const c=Object(s["h"])("div",{class:"block-title"}," 修改個人資料 ",-1),r={class:"tabs",style:{"margin-top":"32px","margin-left":"16px"}};function o(e,t,a,o,i,l){const n=Object(s["D"])("EditUserInfo"),d=Object(s["D"])("ResetPassword");return Object(s["w"])(),Object(s["g"])("div",null,[c,Object(s["h"])("ul",r,[Object(s["h"])("li",{class:Object(s["q"])(["tab",{active:"userInfo"===e.tagKey}]),onClick:t[0]||(t[0]=t=>e.clickTag("userInfo"))},"暱稱修改",2),Object(s["h"])("li",{class:Object(s["q"])(["tab",{active:"password"===e.tagKey}]),onClick:t[1]||(t[1]=t=>e.clickTag("password"))},"重設密碼",2)]),Object(s["k"])(s["b"],{name:"fall"},{default:Object(s["M"])(()=>["userInfo"===e.tagKey?(Object(s["w"])(),Object(s["e"])(n,{key:0})):Object(s["f"])("",!0)]),_:1}),Object(s["k"])(s["b"],{name:"fall"},{default:Object(s["M"])(()=>["password"===e.tagKey?(Object(s["w"])(),Object(s["e"])(d,{key:0})):Object(s["f"])("",!0)]),_:1})])}const i={class:"card round-radius"},l={class:"center-container"},n={class:"avatar-upload"},d={class:"avatar"},u=["src"],b=["src"],p={style:{"margin-top":"16px"}},j=Object(s["h"])("label",{for:"upload",class:"text-btn black"},"上傳大頭照",-1),O={class:"user-info"},m=Object(s["h"])("p",{class:"user-info__label"},"暱稱",-1),h={class:"form-input",style:{"margin-top":"4px"}},g={class:"user-info"},f=Object(s["h"])("p",{class:"user-info__label"},"性別",-1),w={class:"form-radio",style:{"margin-top":"8px"}},v={class:"radio"},_=Object(s["h"])("i",{class:"material-icons un-checked radio__input-icon"},"radio_button_unchecked",-1),y=Object(s["h"])("i",{class:"material-icons checked radio__input-icon"},"radio_button_checked",-1),P=Object(s["h"])("p",{class:"radio__input-text"},"男性",-1),k={class:"radio",style:{"margin-left":"32px"}},U=Object(s["h"])("i",{class:"material-icons un-checked radio__input-icon"},"radio_button_unchecked",-1),x=Object(s["h"])("i",{class:"material-icons checked radio__input-icon"},"radio_button_checked",-1),I=Object(s["h"])("p",{class:"radio__input-text"},"女性",-1),B={key:0,class:"user-info__error-message text-align-center",style:{"margin-top":"32px"}},V={key:1,class:"error-message"};function N(e,t,a,c,r,o){return Object(s["w"])(),Object(s["g"])("div",i,[Object(s["h"])("div",l,[Object(s["h"])("div",n,[Object(s["h"])("div",d,[e.preViewImage?(Object(s["w"])(),Object(s["g"])("img",{key:0,class:"avatar__img",src:e.preViewImage},null,8,u)):(Object(s["w"])(),Object(s["g"])("img",{key:1,class:"avatar__img",src:e.storeUserProfile.photo},null,8,b))]),Object(s["h"])("div",p,[j,Object(s["h"])("input",{id:"upload",style:{visibility:"hidden"},type:"file",accept:"image/png, image/gif, image/jpeg",onChange:t[0]||(t[0]=(...t)=>e.showFile&&e.showFile(...t))},null,32)])]),Object(s["h"])("div",O,[m,Object(s["h"])("div",h,[Object(s["N"])(Object(s["h"])("input",{type:"text",name:"nickname",placeholder:"名稱","onUpdate:modelValue":t[1]||(t[1]=t=>e.storeUserProfile.name=t)},null,512),[[s["J"],e.storeUserProfile.name]])])]),Object(s["h"])("div",g,[f,Object(s["h"])("div",w,[Object(s["h"])("label",v,[Object(s["N"])(Object(s["h"])("input",{type:"radio",name:"gender",class:"radio__input","onUpdate:modelValue":t[2]||(t[2]=t=>e.storeUserProfile.sex=t),value:"male",checked:""},null,512),[[s["I"],e.storeUserProfile.sex]]),_,y,P]),Object(s["h"])("label",k,[Object(s["N"])(Object(s["h"])("input",{type:"radio",name:"gender","onUpdate:modelValue":t[3]||(t[3]=t=>e.storeUserProfile.sex=t),value:"female",class:"radio__input"},null,512),[[s["I"],e.storeUserProfile.sex]]),U,x,I])])]),e.errorNameMessageVised?Object(s["f"])("",!0):(Object(s["w"])(),Object(s["g"])("p",B,"名字不能為空 ")),e.errorImageMessageVised?(Object(s["w"])(),Object(s["g"])("p",V,Object(s["G"])(e.errorImageMessage),1)):Object(s["f"])("",!0),Object(s["h"])("button",{class:"btn secondary",onClick:t[4]||(t[4]=(...t)=>e.updateProfile&&e.updateProfile(...t)),style:{"margin-top":"32px"}}," 送出更新 ")])])}var M=a("5502"),E=a("685c"),R=a("2fe4"),S=a("5464"),z=Object(s["l"])({name:"EditUserInfo",setup(){const e=Object(M["b"])(),t=Object(s["B"])(""),a=Object(s["B"])(""),c=Object(s["B"])(""),r={noContent:"沒有圖片，請選擇圖片上傳",imageSizeError:"解析度寬度至少 300像素以上，請重新輸入",imageTypeError:"圖片格式錯誤，僅限 JPG、PNG 圖片"},o=Object(s["c"])(()=>e.getters["user/storeUserProfile"]),i=Object(s["B"])(""),l=Object(s["B"])(null),n=Object(s["B"])(!0),d=Object(s["B"])(""),u=Object(s["B"])(!0),b=Object(s["B"])("");let p,j=Object(s["A"])({});const O=Object(s["A"])({name:"",thumbnail:null,size:null,unit:"KB"}),m=async e=>{j=e.target.files[0],O.name=j.name,O.thumbnail=window.URL.createObjectURL(j),O.size=~~(.001*j.size),i.value=O.name,l.value=URL.createObjectURL(j),O.size>1e3?(n.value=!0,d.value=r.imageSizeError):Object(S["c"])(O.name)?n.value=!1:(n.value=!0,d.value=r.imageTypeError),p=await Object(E["a"])(j)},h=async()=>{try{if(""===o.value.name)return u.value=!1,!1;const t={name:o.value.name,sex:o.value.sex,photo:p?p.data.imageUrl:o.value.photo},a=await e.dispatch("user/updateUserProfile",t);"success"===a.status&&(await e.dispatch("user/getUserProfile"),await e.dispatch("user/getStoreUserProfile")),Object(R["b"])("成功修改個人資料")}catch(t){return Object(R["a"])(t.message),t}};return Object(s["u"])(async()=>{await e.dispatch("user/getStoreUserProfile")}),{userName:t,photo:a,gender:c,storeUserProfile:o,showFile:m,preViewImage:l,errorImageMessageVised:n,errorImageMessage:d,errorNameMessageVised:u,errorNameMessage:b,updateProfile:h}}}),C=a("d959"),J=a.n(C);const K=J()(z,[["render",N]]);var T=K;const W={class:"card round-radius"},F={class:"center-container"},L={class:"user-password"},q=Object(s["h"])("p",{class:"user-password__label"},"輸入新密碼",-1),D={class:"form-input",style:{"margin-top":"4px"}},G={class:"user-password"},A=Object(s["h"])("p",{class:"user-password__label"},"再次輸入",-1),H={class:"form-input",style:{"margin-top":"4px"}};function Q(e,t,a,c,r,o){return Object(s["w"])(),Object(s["g"])("div",W,[Object(s["h"])("div",F,[Object(s["h"])("div",L,[q,Object(s["h"])("div",D,[Object(s["N"])(Object(s["h"])("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.password=t),type:"password",name:"password",placeholder:"請輸入新密碼"},null,512),[[s["J"],e.password,void 0,{trim:!0}]])])]),Object(s["h"])("div",G,[A,Object(s["h"])("div",H,[Object(s["N"])(Object(s["h"])("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.confirmPassword=t),type:"password",name:"password-confirmation",placeholder:"再次輸入新密碼"},null,512),[[s["J"],e.confirmPassword,void 0,{trim:!0}]])])]),Object(s["h"])("button",{class:Object(s["q"])(["btn",{disabled:!e.checkPassWordSame}]),onClick:t[2]||(t[2]=(...t)=>e.updatePassWord&&e.updatePassWord(...t)),style:{"margin-top":"32px"}},"重設密碼",2)])])}var X=Object(s["l"])({name:"ResetPassword",components:{},setup(){const e=Object(M["b"])(),t=Object(s["B"])(""),a=Object(s["B"])(""),c=Object(s["c"])(()=>t.value===a.value&&Object(S["e"])(t.value)),r=async()=>{c.value||alert("密碼需至少 8 碼以上，並英文、數字混合");const s=await e.dispatch("user/updatePassword",{password:t.value,confirmPassword:a.value});"success"===s.status&&(alert("成功修改個人資料"),await e.dispatch("user/getUserProfile"))};return{password:t,confirmPassword:a,checkPassWordSame:c,updatePassWord:r}}});const Y=J()(X,[["render",Q]]);var Z=Y,$=Object(s["l"])({components:{EditUserInfo:T,ResetPassword:Z},setup(){const e=Object(s["B"])("userInfo");function t(t){e.value=t}return{tagKey:e,clickTag:t}}});const ee=J()($,[["render",o]]);t["default"]=ee}}]);
//# sourceMappingURL=chunk-3fcc58fa.b961744f.js.map