(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cdf129d6"],{"1bab":function(e,t,a){"use strict";a.r(t);var s=a("7a23");const n=Object(s["h"])("div",{class:"block-title"}," 張貼動態 ",-1),c={class:"draft-post"},o={class:"draft-post__post"},r=Object(s["h"])("p",{class:"draft-post__post__label"},"貼文內容",-1),l={class:"draft-post__textarea"},i={style:{"margin-top":"16px"}},u=Object(s["h"])("label",{for:"upload",class:"text-btn black"},"上傳圖片",-1),b=["src"],d={key:1,class:"draft-post__img"},g={key:2,class:"error-message"},p={key:3,class:"error-message"},m={style:{"max-width":"323px margin: 0 auto"}};function j(e,t,a,j,O,h){return Object(s["x"])(),Object(s["g"])("div",null,[n,Object(s["h"])("div",c,[Object(s["h"])("div",o,[r,Object(s["h"])("div",l,[Object(s["O"])(Object(s["h"])("textarea",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),type:"text",name:"nickname",placeholder:"輸入您的貼文內容稱"},null,512),[[s["K"],e.content]])])]),Object(s["h"])("div",i,[u,Object(s["h"])("input",{id:"upload",style:{visibility:"hidden"},type:"file",accept:"image/png, image/gif, image/jpeg",onChange:t[1]||(t[1]=(...t)=>e.showFile&&e.showFile(...t))},null,32)]),e.preViewImage?(Object(s["x"])(),Object(s["g"])("img",{key:0,class:"draft-post__img",style:{"margin-top":"16px"},src:e.preViewImage},null,8,b)):(Object(s["x"])(),Object(s["g"])("div",d)),e.errorImageMessageVised?(Object(s["x"])(),Object(s["g"])("p",g,Object(s["H"])(e.errorImageMessage),1)):Object(s["f"])("",!0),e.errorContentMessageVised?(Object(s["x"])(),Object(s["g"])("p",p,Object(s["H"])(e.errorContentMessage),1)):Object(s["f"])("",!0),Object(s["h"])("div",m,[Object(s["h"])("button",{style:{"margin-top":"32px"},class:"btn secondary",onClick:t[2]||(t[2]=(...t)=>e.submitPost&&e.submitPost(...t))}," 送出貼文 ")])])])}var O=a("5464"),h=a("5502"),f=a("685c"),v=a("a18c"),w=Object(s["l"])({name:"PublishPost",setup(){const e=Object(h["b"])(),t=Object(s["C"])("");let a,n=Object(s["B"])({}),c=Object(s["B"])({name:"",thumbnail:null,size:null,unit:"KB"}),o=Object(s["C"])(""),r=Object(s["C"])(null),l=Object(s["C"])(!0),i=Object(s["C"])(""),u=Object(s["C"])(!0),b=Object(s["C"])("");const d={noContent:"沒有貼文內容，請填寫",imageSizeError:"圖片檔案過大，僅限 1mb 以下檔案",imageTypeError:"圖片格式錯誤，僅限 JPG、PNG 圖片"},g=async e=>{n=e.target.files[0],console.log("showFile",n),c.name=n.name,c.thumbnail=window.URL.createObjectURL(n),c.size=~~(.001*n.size),o.value=c.name,r.value=URL.createObjectURL(n),c.size>1e3?(l.value=!0,i.value=d.imageSizeError):Object(O["c"])(c.name)?l.value=!1:(l.value=!0,i.value=d.imageTypeError),a=await Object(f["a"])(n),console.log("uploadImageRes",a)},p=async()=>{try{var s;if(console.log("submitPost"),u.value=!1,""===t.value)return u.value=!0,b.value=d.noContent,!1;if(l.value)return!1;const n=null===(s=e.getters["user/userProfile"])||void 0===s?void 0:s._id,{status:c,data:o}=await e.dispatch("post/addPost",{userId:n,content:t.value,imgUrl:a.data.imageUrl});console.log(c,o),"success"===c&&v["a"].push({path:"/home"})}catch(n){}};return{content:t,title:o,preViewImage:r,errorImageMessageVised:l,errorImageMessage:i,errorContentMessageVised:u,errorContentMessage:b,showFile:g,submitPost:p}}}),y=a("6b0d"),C=a.n(y);const x=C()(w,[["render",j]]);t["default"]=x},5464:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return n})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return r}));const s=e=>e.length>=2,n=e=>/.+@.+\..+/.test(e),c=e=>/^((?=\S*?[A-Za-z])(?=\S*?[0-9]).{7,})\S$/.test(e),o=(e,t)=>(console.log(e==t),e==t),r=e=>/\.(jpg|png|JPG|PNG|jpeg)$/.test(e)},"685c":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("b775");function n(e){console.log("uploadImage",e);const t=new FormData;return t.append("file",e),Object(s["a"])({url:"/files/uploadImage",method:"POST",data:t})}}}]);
//# sourceMappingURL=chunk-cdf129d6.56e08fec.js.map